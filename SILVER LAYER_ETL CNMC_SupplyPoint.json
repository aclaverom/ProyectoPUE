{"paragraphs":[{"title":"Create new schema as require in the especification","text":"%spark\n\n// First, import the Spark SQL types\nimport org.apache.spark.sql.types._\n\n// Then specify the schema as a `StructType` instance: \nval schemaElectricitySupplyPoint = StructType(Array(\n                                    StructField(\"coddist\", StringType, nullable = false),\n                                    StructField(\"cups\", StringType, nullable = false),\n                                    StructField(\"distribuidora\", StringType, nullable = false),\n                                    StructField(\"codpostal\", IntegerType, false),\n                                    StructField(\"municipioPS\", StringType, nullable = false),\n                                    StructField(\"codigoProvinciaPS\", StringType, false),\n                                    StructField(\"falta\", DateType, false),\n                                    StructField(\"tarifa\", StringType, false),\n                                    StructField(\"tensionps\", IntegerType, false),\n                                    StructField(\"potmaxbie\", StringType, false),\n                                    StructField(\"potenciaMaximaAPMW\", DoubleType, false),\n                                    StructField(\"codigoClasificacionPS\", StringType, false),\n                                    StructField(\"codigoDisponibilidadICP\", StringType, false),\n                                    StructField(\"perfilree\", StringType, false),\n                                    StructField(\"derext\", StringType, false), // Ponemos String en lugar de Double ya que Double  da error\n                                    StructField(\"deraccll\", StringType, false),// Ponemos String en lugar de Double ya que Double  da error\n                                    StructField(\"potcontrp1\", DoubleType, false),\n                                    StructField(\"potcontrp2\", DoubleType, false),\n                                    StructField(\"potcontrp3\", DoubleType, false),\n                                    StructField(\"potcontrp4\", DoubleType, false),\n                                    StructField(\"potcontrp5\", DoubleType, false),\n                                    StructField(\"potcontrp6\", DoubleType, false),\n                                    StructField(\"fechaUltimoMovimientoContrato\", DateType, false),\n                                    StructField(\"fechaUltimoCambioComercializador\", DateType, false),\n                                    StructField(\"fechaLimiteDerechosReconocidos\", DateType, false),\n                                    StructField(\"echaUltimaLectura\", DateType, false),\n                                    StructField(\"informacionImpagos\", StringType, false),\n                                    StructField(\"importeDepositoGarantiaEuros\", StringType, false), // Ponemos String en lugar de Int ya que Int no soporta valores nulos, convertiremos despues si es necesario\n                                    StructField(\"tipoIdTitular\", StringType, false),\n                                    StructField(\"esViviendaHabitual\", StringType, false),\n                                    StructField(\"codigoComercializadora\", StringType, false),\n                                    StructField(\"codigoTelegestion\", StringType, false), // Ponemos String en lugar de Int ya que Int no soporta valores nulos, convertiremos despues si es necesario\n                                    StructField(\"fases\", StringType, false), // Leemos como String ya que el valor que aparece es M o T, no tiene mucho sentido convertirlo a entero\n                                    StructField(\"autoconsumo\", StringType, false), // Leemos como String para luego realizar la conversin a Boolean posteriormente\n                                    StructField(\"codigoTipoContrato\", StringType, false),\n                                    StructField(\"codigoPeriodicidadFacturacion\", StringType, false), // Ponemos String en lugar de Int ya que Int no soporta valores nulos, convertiremos despues si es necesario\n                                    StructField(\"codigoBIE\", StringType, false),\n                                    StructField(\"fechaEmisionBIE\", StringType, true), // Ponemos String en lugar de Date, por algn motivo esta fallando al convertir cuando hay valores nulos\n                                    StructField(\"fechaCaducidadBIE\", StringType, true), // Ponemos String en lugar de Date, por algn motivo esta fallando al convertir cuando hay valores nulos\n                                    StructField(\"codigoAPM\", StringType, false),\n                                    StructField(\"fechaEmisionAPM\", StringType, false), // Ponemos String en lugar de Date, por algn motivo esta fallando al convertir cuando hay valores nulos\n                                    StructField(\"fechaCaducidadAPM\", StringType, false), // Ponemos String en lugar de Date, por algn motivo esta fallando al convertir cuando hay valores nulos\n                                    StructField(\"CNAE\", StringType, false), // Ponemos String en lugar de Int ya que Int no soporta valores nulos, convertiremos despues si es necesario\n                                    StructField(\"codigoModoControlPotencia\", StringType, false), // Ponemos String en lugar de Int ya que Int no soporta valores nulos, convertiremos despues si es necesario\n                                    StructField(\"potenciaCGPW\", StringType, false),\n                                    StructField(\"codigoDHEquipoDeMedida\", StringType, false),\n                                    StructField(\"codigoAccesibilidadContador\", StringType, false),\n                                    StructField(\"codigoPSContratable\", StringType, false), // Ponemos String en lugar de Int ya que Int no soporta valores nulos, convertiremos despues si es necesario\n                                    StructField(\"motivoEstadoNoContratable\", StringType, false), // Ponemos String en lugar de Int ya que Int no soporta valores nulos, convertiremos despues si es necesario\n                                    StructField(\"codigoTensionMedida\", StringType, false), // Ponemos String en lugar de Int ya que Int no soporta valores nulos, convertiremos despues si es necesario\n                                    StructField(\"codigoClaseExpediente\", StringType, false),\n                                    StructField(\"codigoMotivoExpediente\", StringType, false), // Ponemos String en lugar de Int ya que Int no soporta valores nulos, convertiremos despues si es necesario\n                                    StructField(\"codigoTipoSuministro\", StringType, false),\n                                    StructField(\"aplicacionBonoSocial\", StringType, false) // Ponemos String en lugar de Int ya que Int no soporta valores nulos, convertiremos despues si es necesario */\n))\n\nval electricitySupplyPoint = (spark.read\n                                    .format(\"csv\")\n                                    .option(\"sep\", \",\")\n                                    .option(\"header\", \"true\")\n                                    .schema(schemaElectricitySupplyPoint)\n                                    .load(\"/user/azahara/raw/CNMC/201712_SIPS2_PS_ELECTRICIDAD_nacional.csv\"))\n\n//electricitySupplyPoint.show()\nelectricitySupplyPoint.show(2)","user":"anonymous","dateUpdated":"2023-05-20T16:55:27+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true,"title":true,"lineNumbers":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.types._\nschemaElectricitySupplyPoint: org.apache.spark.sql.types.StructType = StructType(StructField(coddist,StringType,false), StructField(cups,StringType,false), StructField(distribuidora,StringType,false), StructField(codpostal,IntegerType,false), StructField(municipioPS,StringType,false), StructField(codigoProvinciaPS,StringType,false), StructField(falta,DateType,false), StructField(tarifa,StringType,false), StructField(tensionps,IntegerType,false), StructField(potmaxbie,StringType,false), StructField(potenciaMaximaAPMW,DoubleType,false), StructField(codigoClasificacionPS,StringType,false), StructField(codigoDisponibilidadICP,StringType,false), StructField(perfilree,StringType,false), StructField(derext,StringType,false), StructField(deraccll,StringType,false), StructField(potcontrp1,Double...electricitySupplyPoint: org.apache.spark.sql.DataFrame = [coddist: string, cups: string ... 52 more fields]\n+-------+--------------------+--------------------+---------+-----------+-----------------+----------+------+---------+---------+------------------+---------------------+-----------------------+---------+------+--------+----------+----------+----------+----------+----------+----------+-----------------------------+--------------------------------+------------------------------+-----------------+------------------+----------------------------+-------------+------------------+----------------------+-----------------+-----+-----------+------------------+-----------------------------+---------+---------------+-----------------+---------+---------------+-----------------+----+-------------------------+------------+----------------------+---------------------------+-------------------+-------------------------+-------------------+---------------------+----------------------+--------------------+--------------------+\n|coddist|                cups|       distribuidora|codpostal|municipioPS|codigoProvinciaPS|     falta|tarifa|tensionps|potmaxbie|potenciaMaximaAPMW|codigoClasificacionPS|codigoDisponibilidadICP|perfilree|derext|deraccll|potcontrp1|potcontrp2|potcontrp3|potcontrp4|potcontrp5|potcontrp6|fechaUltimoMovimientoContrato|fechaUltimoCambioComercializador|fechaLimiteDerechosReconocidos|echaUltimaLectura|informacionImpagos|importeDepositoGarantiaEuros|tipoIdTitular|esViviendaHabitual|codigoComercializadora|codigoTelegestion|fases|autoconsumo|codigoTipoContrato|codigoPeriodicidadFacturacion|codigoBIE|fechaEmisionBIE|fechaCaducidadBIE|codigoAPM|fechaEmisionAPM|fechaCaducidadAPM|CNAE|codigoModoControlPotencia|potenciaCGPW|codigoDHEquipoDeMedida|codigoAccesibilidadContador|codigoPSContratable|motivoEstadoNoContratable|codigoTensionMedida|codigoClaseExpediente|codigoMotivoExpediente|codigoTipoSuministro|aplicacionBonoSocial|\n+-------+--------------------+--------------------+---------+-----------+-----------------+----------+------+---------+---------+------------------+---------------------+-----------------------+---------+------+--------+----------+----------+----------+----------+----------+----------+-----------------------------+--------------------------------+------------------------------+-----------------+------------------+----------------------------+-------------+------------------+----------------------+-----------------+-----+-----------+------------------+-----------------------------+---------+---------------+-----------------+---------+---------------+-----------------+----+-------------------------+------------+----------------------+---------------------------+-------------------+-------------------------+-------------------+---------------------+----------------------+--------------------+--------------------+\n|   0021|ES0021000009557116XS|IBERDROLA DISTRIB...|    48002|      48020|               48|1978-02-03|   001|        9|     3300|              null|                   05|                      1|       PA|  3300|    3300|       1.0|       1.0|    3300.0|      null|      null|      null|                         null|                            null|                    2009-06-30|       2013-09-26|        9999-01-01|                  2017-11-08|         null|              null|                    NI|                0| null|         01|                 M|                           00|     null|           null|             null|     null|           null|             null|null|                     null|        null|                  9820|                          1|               null|                     null|               null|                    1|                  null|                null|                null|\n|   0021|ES0021000009557115XZ|IBERDROLA DISTRIB...|    48002|      48020|               48|1976-07-19|   001|        9|     3300|              null|                   05|                      1|       PA|  3300|    3300|       1.0|       1.0|    3300.0|      null|      null|      null|                         null|                            null|                    2009-06-30|       2009-06-30|        9999-01-01|                  2017-11-08|         null|              null|                    NI|                0| null|         01|                 M|                           00|     null|           null|             null|     null|           null|             null|null|                     null|        null|                  9820|                          1|               null|                     null|               null|                    1|                  null|                null|                null|\n+-------+--------------------+--------------------+---------+-----------+-----------------+----------+------+---------+---------+------------------+---------------------+-----------------------+---------+------+--------+----------+----------+----------+----------+----------+----------+-----------------------------+--------------------------------+------------------------------+-----------------+------------------+----------------------------+-------------+------------------+----------------------+-----------------+-----+-----------+------------------+-----------------------------+---------+---------------+-----------------+---------+---------------+-----------------+----+-------------------------+------------+----------------------+---------------------------+-------------------+-------------------------+-------------------+---------------------+----------------------+--------------------+--------------------+\nonly showing top 2 rows"}]},"apps":[],"jobName":"paragraph_1684165305477_44330742","id":"20230515-174145_1550071265","dateCreated":"2023-05-15T17:41:45+0200","dateStarted":"2023-05-20T16:55:27+0200","dateFinished":"2023-05-20T16:55:31+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1766"},{"title":"Schema modified","text":"%spark\n\nelectricitySupplyPoint.printSchema()","user":"anonymous","dateUpdated":"2023-05-20T11:13:47+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- coddist: string (nullable = true)\n |-- cups: string (nullable = true)\n |-- distribuidora: string (nullable = true)\n |-- codigoPostalPS: integer (nullable = true)\n |-- municipioPS: string (nullable = true)\n |-- codigoProvinciaPS: string (nullable = true)\n |-- falta: date (nullable = true)\n |-- tarifa: string (nullable = true)\n |-- tensionps: integer (nullable = true)\n |-- potmaxbie: string (nullable = true)\n |-- potenciaMaximaAPMW: double (nullable = true)\n |-- codigoClasificacionPS: string (nullable = true)\n |-- codigoDisponibilidadICP: string (nullable = true)\n |-- perfilree: string (nullable = true)\n |-- potcontrp1: double (nullable = true)\n |-- potcontrp2: double (nullable = true)\n |-- potcontrp3: double (nullable = true)\n |-- potcontrp4: double (nullable = true)\n |-- potcontrp5: double (nullable = true)\n |-- potcontrp6: double (nullable = true)\n |-- fechaUltimoMovimientoContrato: date (nullable = true)\n |-- fechaUltimoCambioComercializador: date (nullable = true)\n |-- fechaLimiteDerechosReconocidos: date (nullable = true)\n |-- echaUltimaLectura: date (nullable = true)\n |-- informacionImpagos: string (nullable = true)\n |-- importeDepositoGarantiaEuros: integer (nullable = true)\n |-- tipoIdTitular: string (nullable = true)\n |-- esViviendaHabitual: string (nullable = true)\n |-- codigoComercializadora: string (nullable = true)\n |-- codigoTelegestion: integer (nullable = true)\n |-- fases: integer (nullable = true)\n |-- autoconsumo: boolean (nullable = true)\n |-- codigoTipoContrato: string (nullable = true)\n |-- codigoPeriodicidadFacturacion: integer (nullable = true)\n |-- codigoBIE: string (nullable = true)\n |-- fechaEmisionBIE: date (nullable = true)\n |-- fechaCaducidadBIE: date (nullable = true)\n |-- codigoAPM: string (nullable = true)\n |-- fechaEmisionAPM: date (nullable = true)\n |-- fechaCaducidadAPM: date (nullable = true)\n |-- CNAE: integer (nullable = true)\n |-- codigoModoControlPotencia:: integer (nullable = true)\n |-- potenciaCGPW: string (nullable = true)\n |-- codigoDHEquipoDeMedida: string (nullable = true)\n |-- codigoAccesibilidadContador: string (nullable = true)\n |-- codigoPSContratable: integer (nullable = true)\n |-- motivoEstadoNoContratable: integer (nullable = true)\n |-- codigoTensionMedida: integer (nullable = true)\n |-- codigoClaseExpediente: string (nullable = true)\n |-- codigoMotivoExpediente: integer (nullable = true)\n |-- codigoTipoSuministro: string (nullable = true)\n |-- aplicacionBonoSocial: integer (nullable = true)"}]},"apps":[],"jobName":"paragraph_1684160790886_-442555697","id":"20230515-162630_1335091184","dateCreated":"2023-05-15T16:26:30+0200","dateStarted":"2023-05-18T20:54:58+0200","dateFinished":"2023-05-18T20:55:00+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1767"},{"title":"Changing colums types","text":"%spark\nval electricitySupplyPointMod = {electricitySupplyPoint\n  .withColumn(\"derext\", when(col(\"derext\").isNull, lit(0.0)).otherwise(col(\"derext\").cast(DoubleType)))\n  .withColumn(\"deraccll\", when(col(\"deraccll\").isNull, lit(0.0)).otherwise(col(\"deraccll\").cast(DoubleType)))\n  .withColumn(\"importeDepositoGarantiaEuros\", when(col(\"importeDepositoGarantiaEuros\").isNull, lit(0)).otherwise(col(\"importeDepositoGarantiaEuros\").cast(IntegerType)))\n  .withColumn(\"codigoTelegestion\", when(col(\"codigoTelegestion\").isNull, lit(0)).otherwise(col(\"codigoTelegestion\").cast(IntegerType)))\n  .withColumn(\"autoconsumo\", when(col(\"autoconsumo\").isNull, false).otherwise(true))\n  .withColumn(\"codigoPeriodicidadFacturacion\", when(col(\"codigoPeriodicidadFacturacion\").isNull, lit(0)).otherwise(col(\"codigoPeriodicidadFacturacion\").cast(IntegerType)))\n  .withColumn(\"fechaEmisionBIE\", when(col(\"fechaEmisionBIE\").isNull, lit(null)).otherwise(col(\"fechaEmisionBIE\").cast(DateType)))\n  .withColumn(\"fechaCaducidadBIE\", when(col(\"fechaCaducidadBIE\").isNull, lit(null)).otherwise(col(\"fechaCaducidadBIE\").cast(DateType)))\n  .withColumn(\"fechaEmisionAPM\", when(col(\"fechaEmisionAPM\").isNull, lit(null)).otherwise(col(\"fechaEmisionAPM\").cast(DateType)))\n  .withColumn(\"fechaCaducidadAPM\", when(col(\"fechaCaducidadAPM\").isNull, lit(null)).otherwise(col(\"fechaCaducidadAPM\").cast(DateType)))\n  .withColumn(\"CNAE\", when(col(\"CNAE\").isNull, lit(0)).otherwise(col(\"CNAE\").cast(IntegerType)))\n  .withColumn(\"codigoModoControlPotencia\", when(col(\"codigoModoControlPotencia\").isNull, lit(0)).otherwise(col(\"codigoModoControlPotencia\").cast(IntegerType)))\n  .withColumn(\"codigoPSContratable\", when(col(\"codigoPSContratable\").isNull, lit(0)).otherwise(col(\"codigoPSContratable\").cast(IntegerType)))\n  .withColumn(\"motivoEstadoNoContratable\", when(col(\"motivoEstadoNoContratable\").isNull, lit(0)).otherwise(col(\"motivoEstadoNoContratable\").cast(IntegerType)))\n  .withColumn(\"codigoTensionMedida\", when(col(\"codigoTensionMedida\").isNull, lit(0)).otherwise(col(\"codigoTensionMedida\").cast(IntegerType)))\n  .withColumn(\"codigoMotivoExpediente\", when(col(\"codigoMotivoExpediente\").isNull, lit(0)).otherwise(col(\"codigoMotivoExpediente\").cast(IntegerType)))\n  .withColumn(\"aplicacionBonoSocial\", when(col(\"aplicacionBonoSocial\").isNull, lit(0)).otherwise(col(\"aplicacionBonoSocial\").cast(IntegerType))) }\n                                    \n                                  \n                 \n                                  ","user":"anonymous","dateUpdated":"2023-05-20T16:55:42+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true,"lineNumbers":true,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"electricitySupplyPointMod: org.apache.spark.sql.DataFrame = [coddist: string, cups: string ... 52 more fields]"}]},"apps":[],"jobName":"paragraph_1684569718980_-1543891550","id":"20230520-100158_1203882596","dateCreated":"2023-05-20T10:01:58+0200","dateStarted":"2023-05-20T16:55:42+0200","dateFinished":"2023-05-20T16:55:44+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1768"},{"text":"%spark\nelectricitySupplyPointMod.select(\"fechaEmisionAPM\")","user":"anonymous","dateUpdated":"2023-05-20T11:13:47+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------+\n|fechaEmisionAPM|\n+---------------+\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n|           null|\n+---------------+\nonly showing top 100 rows"}]},"apps":[],"jobName":"paragraph_1684571191379_1409632754","id":"20230520-102631_988452440","dateCreated":"2023-05-20T10:26:31+0200","dateStarted":"2023-05-20T11:12:13+0200","dateFinished":"2023-05-20T11:12:15+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1769"},{"title":"Convert to parquet","text":"%spark\n\nval SIPSPath = \"/user/azahara/refined/CNMC/201712_SIPS2_PS_ELECTRICIDAD_nacional\"\n\nelectricitySupplyPoint.write.mode(\"overwrite\").parquet(SIPSPath)\n\n\n","user":"anonymous","dateUpdated":"2023-05-20T16:55:49+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true,"tableHide":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"SIPSPath: String = /user/azahara/refined/CNMC/201712_SIPS2_PS_ELECTRICIDAD_nacional"}]},"apps":[],"jobName":"paragraph_1684268944976_2044556070","id":"20230516-222904_1498383898","dateCreated":"2023-05-16T22:29:04+0200","dateStarted":"2023-05-20T16:55:50+0200","dateFinished":"2023-05-20T16:55:56+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1770"},{"title":"Showing modified schema","text":"%spark\n\nval dataFrameFromParquet = spark.read.parquet(\"/user/azahara/refined/CNMC/201712_SIPS2_PS_ELECTRICIDAD_nacional\")\n\nelectricitySupplyPointMod.printSchema()","user":"anonymous","dateUpdated":"2023-05-20T11:13:47+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"dataFrameFromParquet: org.apache.spark.sql.DataFrame = [coddist: string, cups: string ... 52 more fields]\nroot\n |-- coddist: string (nullable = true)\n |-- cups: string (nullable = true)\n |-- distribuidora: string (nullable = true)\n |-- codigoPostalPS: integer (nullable = true)\n |-- municipioPS: string (nullable = true)\n |-- codigoProvinciaPS: string (nullable = true)\n |-- falta: date (nullable = true)\n |-- tarifa: string (nullable = true)\n |-- tensionps: integer (nullable = true)\n |-- potmaxbie: string (nullable = true)\n |-- potenciaMaximaAPMW: double (nullable = true)\n |-- codigoClasificacionPS: string (nullable = true)\n |-- codigoDisponibilidadICP: string (nullable = true)\n |-- perfilree: string (nullable = true)\n |-- derext: double (nullable = true)\n |-- deraccll: double (nullable = true)\n |-- potcontrp1: double (nullable = true)\n |-- potcontrp2: double (nullable = true)\n |-- potcontrp3: double (nullable = true)\n |-- potcontrp4: double (nullable = true)\n |-- potcontrp5: double (nullable = true)\n |-- potcontrp6: double (nullable = true)\n |-- fechaUltimoMovimientoContrato: date (nullable = true)\n |-- fechaUltimoCambioComercializador: date (nullable = true)\n |-- fechaLimiteDerechosReconocidos: date (nullable = true)\n |-- echaUltimaLectura: date (nullable = true)\n |-- informacionImpagos: string (nullable = true)\n |-- importeDepositoGarantiaEuros: integer (nullable = true)\n |-- tipoIdTitular: string (nullable = true)\n |-- esViviendaHabitual: string (nullable = true)\n |-- codigoComercializadora: string (nullable = true)\n |-- codigoTelegestion: integer (nullable = true)\n |-- fases: string (nullable = true)\n |-- autoconsumo: boolean (nullable = false)\n |-- codigoTipoContrato: string (nullable = true)\n |-- codigoPeriodicidadFacturacion: integer (nullable = true)\n |-- codigoBIE: string (nullable = true)\n |-- fechaEmisionBIE: date (nullable = true)\n |-- fechaCaducidadBIE: date (nullable = true)\n |-- codigoAPM: string (nullable = true)\n |-- fechaEmisionAPM: date (nullable = true)\n |-- fechaCaducidadAPM: date (nullable = true)\n |-- CNAE: integer (nullable = true)\n |-- codigoModoControlPotencia: integer (nullable = true)\n |-- potenciaCGPW: string (nullable = true)\n |-- codigoDHEquipoDeMedida: string (nullable = true)\n |-- codigoAccesibilidadContador: string (nullable = true)\n |-- codigoPSContratable: integer (nullable = true)\n |-- motivoEstadoNoContratable: integer (nullable = true)\n |-- codigoTensionMedida: integer (nullable = true)\n |-- codigoClaseExpediente: string (nullable = true)\n |-- codigoMotivoExpediente: integer (nullable = true)\n |-- codigoTipoSuministro: string (nullable = true)\n |-- aplicacionBonoSocial: integer (nullable = true)"}]},"apps":[],"jobName":"paragraph_1684265281422_617314394","id":"20230516-212801_2029919128","dateCreated":"2023-05-16T21:28:01+0200","dateStarted":"2023-05-20T11:13:34+0200","dateFinished":"2023-05-20T11:13:36+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1771"}],"name":"SILVER LAYER/ETL CNMC_SupplyPoint","id":"2J1MXR6GU","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"livy:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}