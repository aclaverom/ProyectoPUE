{"paragraphs":[{"title":"Dropping table","text":"%sql\nDROP TABLE IF EXISTS SIPS","user":"anonymous","dateUpdated":"2023-05-23T08:18:55+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","tableHide":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""}]},"apps":[],"jobName":"paragraph_1684511289914_-535209960","id":"20230519-174809_2005248183","dateCreated":"2023-05-19T17:48:09+0200","dateStarted":"2023-05-23T08:18:16+0200","dateFinished":"2023-05-23T08:18:17+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:15000"},{"title":"Create temporary view from SIPSCO table to obtain max power","text":"%sql\n\nCREATE TEMPORARY VIEW max_values AS\nSELECT \n    MAX(potmaxp1 ) AS potmaxp1, \n    MAX(potmaxp2) AS potmaxp2, \n    MAX(potmaxp3 ) AS potmaxp3, \n    MAX(potmaxp4) AS potmaxp4,\n    MAX(potmaxp5 ) AS potmaxp5, \n    MAX(potmaxp6) AS potmaxp6\nFROM SIPSCO\n\n\n","user":"anonymous","dateUpdated":"2023-05-23T08:18:55+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""}]},"apps":[],"jobName":"paragraph_1684514453748_1947466219","id":"20230519-184053_823391225","dateCreated":"2023-05-19T18:40:53+0200","dateStarted":"2023-05-23T08:18:19+0200","dateFinished":"2023-05-23T08:18:20+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:15001"},{"title":"Create table SIPS joining max power from table sipsco","text":"%sql\n\nCREATE TABLE SIPS AS\nSELECT  cups, \n        distribuidora, \n        coddist, \n        falta, \n        tarifa, \n        tensionps, \n        fases, \n        potmaxbie, \n        derext, \n        deraccll, \n        perfilree, \n        potcontrp1, \n        potcontrp2, \n        potcontrp3, \n        potcontrp4, \n        potcontrp5,\n        potcontrp6, \n        autoconsumo\n\nFROM cnmc_sips\n\nCROSS JOIN max_values\n","user":"anonymous","dateUpdated":"2023-05-23T08:18:55+0200","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"lineNumbers":true,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""}]},"apps":[],"jobName":"paragraph_1684510653729_-952689693","id":"20230519-170036_43028335","dateCreated":"2023-05-19T17:37:33+0200","dateStarted":"2023-05-23T08:18:22+0200","dateFinished":"2023-05-23T08:18:27+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:15002"},{"title":"Show table SIPS","text":"%sql\n\nselect * from SIPS LIMIT 5","user":"anonymous","dateUpdated":"2023-05-23T08:18:55+0200","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"cups":"string","distribuidora":"string","coddist":"string","falta":"string","tarifa":"string","tensionps":"string","fases":"string","potmaxbie":"string","derext":"string","deraccll":"string","perfilree":"string","potcontrp1":"string","potcontrp2":"string","potcontrp3":"string","potcontrp4":"string","potcontrp5":"string","potcontrp6":"string","autoconsumo":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"cups\tdistribuidora\tcoddist\tfalta\ttarifa\ttensionps\tfases\tpotmaxbie\tderext\tderaccll\tperfilree\tpotcontrp1\tpotcontrp2\tpotcontrp3\tpotcontrp4\tpotcontrp5\tpotcontrp6\tautoconsumo\nES002200000718869...\tUNION FENOSA DIST...\t0022\t1990-04-20\t001\t1\tnull\t5750\t5500\t5500\tPA\t1.0\t2.0\t3300.0\tnull\tnull\tnull\t01\nES002200000718532...\tUNION FENOSA DIST...\t0022\t1990-04-06\t011\t26\tnull\t80000\t80000\t80000\tPD\t1.0\t4.0\t5000.0\t50000.0\t50000.0\tnull\t02\nES002200000717497...\tUNION FENOSA DIST...\t0022\t1990-02-26\t004\t6\tnull\t5196\t5196\t5196\tPC\t1.0\t4.0\t5196.0\t5196.0\tnull\tnull\t01\nES002200000717916...\tUNION FENOSA DIST...\t0022\t1990-03-14\t001\t2\tnull\t5750\t5500\t4600\tPA\t1.0\t2.0\t4600.0\tnull\tnull\tnull\t01\nES002200000718958...\tUNION FENOSA DIST...\t0022\t1990-04-24\t001\t4\tnull\t13856\t11400\t6600\tPA\t1.0\t2.0\t6600.0\tnull\tnull\tnull\t01"}]},"apps":[],"jobName":"paragraph_1684510653733_-1572366515","id":"20230519-170936_2133531055","dateCreated":"2023-05-19T17:37:33+0200","dateStarted":"2023-05-23T08:18:49+0200","dateFinished":"2023-05-23T08:18:51+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:15003"},{"title":"Convert to parquet","text":"%spark\n\n// read SQL and load information in DF\nval dfSIPS = spark.sql(\"SELECT * FROM SIPS \")\n\n// Path or parquet file\nval SIPSPath = \"/user/azahara/trusted/SIPS\"\n\n// writting parquet file\ndfSIPS.write.mode(\"overwrite\").parquet(SIPSPath)\n\n","user":"anonymous","dateUpdated":"2023-05-23T08:18:55+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true,"tableHide":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"dfSIPS: org.apache.spark.sql.DataFrame = [cups: string, distribuidora: string ... 16 more fields]\nSIPSPath: String = /user/azahara/trusted/SIPS"}]},"apps":[],"jobName":"paragraph_1684510653735_1039269452","id":"20230519-171801_1449564974","dateCreated":"2023-05-19T17:37:33+0200","dateStarted":"2023-05-23T08:18:36+0200","dateFinished":"2023-05-23T08:18:38+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:15004"},{"text":"%spark\n","user":"anonymous","dateUpdated":"2023-05-23T08:18:55+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1684822716041_-679040127","id":"20230523-081836_1894788108","dateCreated":"2023-05-23T08:18:36+0200","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:18202"}],"name":"GOLD LAYER/table SIPS","id":"2J1UEZPMJ","noteParams":{},"noteForms":{},"angularObjects":{"sh:shared_process":[],"livy:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}