{"paragraphs":[{"title":"Read a JSON file","text":"%spark\nval contracts = spark.read.json(\"/user/azahara/raw/contracts/contracts.json\")\n","user":"anonymous","dateUpdated":"2023-05-21T07:03:56+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"contracts: org.apache.spark.sql.DataFrame = [contract_date: string, contract_number: string ... 7 more fields]"}]},"apps":[],"jobName":"paragraph_1684165836869_1073181178","id":"20230515-175036_2129922096","dateCreated":"2023-05-15T17:50:36+0200","dateStarted":"2023-05-21T07:02:47+0200","dateFinished":"2023-05-21T07:02:54+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2406"},{"title":"Contracts Schema","text":"%spark\ncontracts.printSchema()","user":"anonymous","dateUpdated":"2023-05-21T07:03:56+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- contract_date: string (nullable = true)\n |-- contract_number: string (nullable = true)\n |-- cups: string (nullable = true)\n |-- discount: boolean (nullable = true)\n |-- fiscal_address: struct (nullable = true)\n |    |-- city: string (nullable = true)\n |    |-- country: string (nullable = true)\n |    |-- street: string (nullable = true)\n |    |-- zip_code: string (nullable = true)\n |-- id: string (nullable = true)\n |-- personal_data: struct (nullable = true)\n |    |-- address: struct (nullable = true)\n |    |    |-- city: string (nullable = true)\n |    |    |-- country: string (nullable = true)\n |    |    |-- street: string (nullable = true)\n |    |    |-- zip_code: string (nullable = true)\n |    |-- email: string (nullable = true)\n |    |-- first_name: string (nullable = true)\n |    |-- last_name: string (nullable = true)\n |    |-- phone: string (nullable = true)\n |-- product: struct (nullable = true)\n |    |-- code: string (nullable = true)\n |    |-- description: string (nullable = true)\n |    |-- id: long (nullable = true)\n |-- status: string (nullable = true)"}]},"apps":[],"jobName":"paragraph_1684342167839_-1863291478","id":"20230517-184927_264295640","dateCreated":"2023-05-17T18:49:27+0200","dateStarted":"2023-05-17T18:59:36+0200","dateFinished":"2023-05-17T18:59:37+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2407"},{"title":"Rename columns","text":"\n%spark\nval renamedContracts = (contracts\n                        .withColumn(\"codpostal\", col(\"fiscal_address.zip_code\"))     \n                        .withColumn(\"email\", col(\"personal_data.email\"))\n                        .withColumnRenamed(\"contract_number\",\"numcontrato\") \n                        .withColumnRenamed(\"contract_date\" ,\"fcontrato\")\n                        .withColumnRenamed(\"id\", \"codproducto\") ) // asumimos que codproducto es el id \n\n\n\nrenamedContracts.show\n\n","user":"anonymous","dateUpdated":"2023-05-21T07:03:56+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"renamedContracts: org.apache.spark.sql.DataFrame = [fcontrato: string, numcontrato: string ... 9 more fields]\n+--------------------+-----------+--------------------+--------+--------------------+--------------------+--------------------+--------------------+--------+---------+--------------------+\n|           fcontrato|numcontrato|                cups|discount|      fiscal_address|         codproducto|       personal_data|             product|  status|codpostal|               email|\n+--------------------+-----------+--------------------+--------+--------------------+--------------------+--------------------+--------------------+--------+---------+--------------------+\n|Jan 18, 2018 8:31...|   00318293|ES002200000404356...|   false|[Jerez de la Fron...|1b009a4526c52ac2a...|[[Zamora, España,...|[ELECT_FIJO, Elec...|  ACTIVO|    26533|reina.garica.dumm...|\n|Jan 19, 2018 1:22...|   00487531|ES002200000824487...|   false|[Segovia, España,...|9c901ea5b4b716455...|[[Granada, España...|[ELECT_FIJO, Elec...|INACTIVO|    77297|benito.chapa.dumm...|\n|Jan 30, 2018 8:31...|   00912523|ES002200000824543...|    true|[Santa Coloma de ...|3d0aa1b5b11b41cb3...|[[Benalmádena, Es...|    [ELECT_VIP, , 3]|  ACTIVO|    14162|ester.burgos.dumm...|\n|Jan 14, 2018 9:31...|   00678073|ES002200000403974...|    true|[Sanlúcar de Barr...|34a54d5ec535aa040...|[[Ciudad Real, Es...|[ELECT_FLEXI, Ele...|  ACTIVO|    50524|carlota.lovato.du...|\n|Jan 13, 2018 8:11...|   00547151|ES002200000404119...|   false|[Dos Hermanas, Es...|c97c93fa9a1221452...|[[Chiclana de la ...|[ELECT_FIJO, Elec...|INACTIVO|    48435|horacio.vanegas.d...|\n|Jan 7, 2018 5:37:...|   00067996|ES002200000400228...|   false|[Mataró, España, ...|76446b8d6a56e2bac...|[[Orense, España,...|[ELECT_FIJO, Elec...|INACTIVO|    13813|pedro.negron.dumm...|\n|Jan 12, 2018 8:14...|   00770228|ES002200000438791...|   false|[Sanlúcar de Barr...|5b3aa04830e535dd9...|[[Vitoria, España...|    [ELECT_VIP, , 3]|  ACTIVO|    00303|victor.zuniga.dum...|\n|Jan 31, 2018 3:32...|   00579150|ES002200000438841...|   false|[Mijas, España, S...|5215c5b0cf85181da...|[[Elda, España, R...|[ELECT_FIJO, Elec...|  ACTIVO|    14078|diego.herrera.dum...|\n|Jan 3, 2018 3:40:...|   00037160|ES002200000438888...|   false|[Roquetas de Mar,...|51d2b3c68b6aef642...|[[Majadahonda, Es...|[ELECT_FLEXI, Ele...|  ACTIVO|    75035|jorge luis.carras...|\n|Jan 11, 2018 6:24...|   00163486|ES002200000438914...|   false|[Huelva, España, ...|cb7aeae1a951c9fcd...|[[Sagunto, España...|    [ELECT_VIP, , 3]|  ACTIVO|    09527|rosalia.delgado.d...|\n|Jan 28, 2018 2:55...|   00041712|ES002200000438988...|    true|[Cartagena, Españ...|38ecd8e574141cc1b...|[[Bilbao, España,...|[ELECT_FLEXI, Ele...|  ACTIVO|    30359|esteban.cuellar.d...|\n|Jan 12, 2018 5:59...|   00687884|ES002200000400539...|    true|[Salamanca, Españ...|11e34478099e4da20...|[[Móstoles, Españ...|    [ELECT_VIP, , 3]|  ACTIVO|    66053|magdalena.cavazos...|\n|Jan 12, 2018 2:45...|   00762187|ES002200000824461...|    true|[Mataró, España, ...|3168759f6e76b3942...|[[Collado Villalb...|    [ELECT_VIP, , 3]|  ACTIVO|    41275|beatriz.portillo....|\n|Jan 7, 2018 4:05:...|   00076659|ES002200000438846...|   false|[Santander, Españ...|1b0afa29cde0e870b...|[[Barcelona, Espa...|[ELECT_FLEXI, Ele...|  ACTIVO|    75134|marilu.negrete.du...|\n|Jan 12, 2018 7:32...|   00804404|ES002200000438972...|    true|[Las Palmas de Gr...|3064b2b77a5a52f2a...|[[León, España, V...|[ELECT_FIJO, Elec...|  ACTIVO|    26068|jorge luis.candel...|\n|Jan 8, 2018 1:55:...|   00324155|ES002200000404125...|    true|[Sanlúcar de Barr...|4369666f4320dbd95...|[[Talavera de la ...|[ELECT_FIJO, Elec...|  ACTIVO|    08643|jose.mota.dummy@g...|\n|Jan 25, 2018 5:18...|   00602740|ES002200000404135...|    true|[Valladolid, Espa...|7b93d8b7c7eb2cbe2...|[[Palencia, Españ...|[ELECT_FIJO, Elec...|  ACTIVO|    89469|guillermo.espinal...|\n|Jan 21, 2018 2:26...|   00392460|ES002200000404239...|    true|[Valdemoro, Españ...|a36a301d7cdefc935...|[[Irún, España, S...|    [ELECT_VIP, , 3]|INACTIVO|    69850|silvia.trujillo.d...|\n|Jan 3, 2018 12:32...|   00193239|ES002200000400183...|    true|[Coslada, España,...|e9472a41af06f550a...|[[El Ejido, Españ...|[ELECT_FLEXI, Ele...|  ACTIVO|    74220|juan.carrera.dumm...|\n|Jan 14, 2018 8:05...|   00490167|ES002200000400331...|   false|[Calahorra, Españ...|544142285a336a9e6...|[[Guadalajara, Es...|    [ELECT_VIP, , 3]|INACTIVO|    32599|octavio.mireles.d...|\n+--------------------+-----------+--------------------+--------+--------------------+--------------------+--------------------+--------------------+--------+---------+--------------------+\nonly showing top 20 rows"}]},"apps":[],"jobName":"paragraph_1684594685630_1033131273","id":"20230520-165805_30573502","dateCreated":"2023-05-20T16:58:05+0200","dateStarted":"2023-05-21T07:03:00+0200","dateFinished":"2023-05-21T07:03:03+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2408"},{"title":"Convert to parquet","text":"%spark\nval contractsPath = \"/user/azahara/refined/contracts/contracts.parquet\"\n\nrenamedContracts.write.mode(\"overwrite\").format(\"parquet\").save(contractsPath)\n\n","user":"anonymous","dateUpdated":"2023-05-21T07:03:56+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true,"tableHide":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"contractsPath: String = /user/azahara/refined/contracts/contracts.parquet"}]},"apps":[],"jobName":"paragraph_1684614677278_-853351621","id":"20230520-223117_1887721037","dateCreated":"2023-05-20T22:31:17+0200","dateStarted":"2023-05-21T07:03:29+0200","dateFinished":"2023-05-21T07:03:33+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2409"}],"name":"SILVER LAYER/ETL contracts","id":"2HYRKAG23","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"livy:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}